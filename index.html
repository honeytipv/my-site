<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>개꿀팁</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        margin: 0;
        font-family: sans-serif;
      }

      /* 처음 동의서 */
      #consentScreen {
        position: fixed;
        z-index: 99999;
        background: white;
        color: black;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        overflow-y: auto;
        padding: 30px 20px;
      }

      #copyright {
        position: absolute;
        top: 10px;
        left: 15px;
        font-size: 12px;
        color: #666;
      }

      .notice {
        font-weight: bold;
        color: red;
        margin-top: 40px;
        margin-bottom: 20px;
      }

      .consent-buttons {
        margin-top: 30px;
      }

      .consent-buttons button {
        padding: 10px 18px;
        font-size: 16px;
        margin-right: 10px;
        border-radius: 5px;
        border: none;
        background-color: purple;
        color: white;
        cursor: pointer;
      }

      .modal-law {
        display: none;
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
      }

      .modal-law-content {
        background: white;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 600px;
        margin: 100px auto;
        position: relative;
        white-space: pre-wrap;
        max-height: 80vh;
        overflow-y: auto;
      }

      .modal-law .close-button {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        cursor: pointer;
      }

      .top-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        background: #f5f5f5;
      }

      .help-box {
        display: flex;
        flex-direction: column;
        align-items: center;
        cursor: pointer;
      }

      .help-icon {
        width: 40px;
        height: 40px;
      }

      .label {
        font-size: 12px;
        color: #333;
      }

      .container {
        padding: 10px;
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 10000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
      }

      .modal-content {
        background-color: #fefefe;
        margin: 10% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 90%;
        max-width: 500px;
        position: relative;
      }

      .modal-content textarea {
        width: 100%;
        resize: none;
      }

      .close-button {
        position: absolute;
        right: 15px;
        top: 10px;
        font-size: 20px;
        cursor: pointer;
      }

      /* 스크롤 바 커짐 */
      ::-webkit-scrollbar {
        width: 10px;
      }
      ::-webkit-scrollbar-thumb {
        background-color: gray;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <!-- 동의서 화면 -->
    <div id="consentScreen">
      <div id="copyright">© 2025 개꿀팁. 무단 복제 및 재배포 금지.</div>
      <p class="notice">※ 개꿀팁 기능을 이용하려면 아래 자세히 보기를 반드시 확인해 주세요.</p>
      <div class="consent-buttons">
        <button id="consentAgree">동의</button>
        <button id="showLawModal">자세히 보기</button>
      </div>
    </div>

    <!-- 법적 고지 모달 -->
    <div id="lawModal" class="modal-law">
      <div class="modal-law-content">
        <span class="close-button" id="closeLawModal">×</span>
        <strong>[의견 제출 기능 이용에 대한 고지 및 법적 동의서]</strong>

        본 웹페이지의 의견 제출 기능은 외부 메일 처리 서비스(Formspree.io)의 송신 인터페이스를 기반으로 운영되며, 사용자가 입력한 이메일 주소 및 의견 내용은 운영자에게 직접 전달됩니다.

        이에 따라 사용자는 의견 제출 이전에 다음 사항을 충분히 숙지하고, 이에 전적으로 동의한 것으로 간주됩니다.

        1. 본 페이지 내 스크립트에 포함된 Formspree 메일 송신 경로 또는 링크를 임의로 열람·조작하거나, 타인의 메일 주소를 무단으로 도용하여 메시지를 전송하는 행위는 부정 접속 및 기능 변조로 간주될 수 있습니다.

        2. 수신자 이메일 주소를 대상으로 욕설, 도배, 광고, 비방, 모욕, 성적 표현, 협박 등 사회적으로 부적절하거나 법률 위반 소지가 있는 내용을 반복적으로 전송할 경우, 「형법」 및 「정보통신망법」 등에 따라 민·형사상 법적 책임이 발생할 수 있습니다.

        3. 본 시스템은 서버 로그를 수집하거나 IP 정보를 기록하지 않지만, 전송된 메시지 및 메일 수신 시점 등의 기록은 보존될 수 있으며, 운영자 판단에 따라 법적 조치를 요청할 수 있습니다.

        사용자는 위 사항을 충분히 이해하였으며, 이에 전적으로 동의합니다.
      </div>
    </div>

    <!-- 메인 콘텐츠 -->
    <div id="mainApp" style="display: none;">
      <div class="top-bar">
        <input type="text" id="searchInput" placeholder="숫자를 검색하세요 (예: 1)" />
        <div class="help-box" id="openModal">
          <img
            src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSoYnzdTBQO1svckSLMMg75P7ZQ51xkkMyccbffdrJ2&s"
            alt="고객센터"
            class="help-icon"
          />
          <div class="label">의견센터</div>
        </div>
      </div>

      <div class="container" id="results"></div>

      <div id="feedbackModal" class="modal">
        <div class="modal-content">
          <span class="close-button" id="closeModal">×</span>
          <p style="font-size: 15px; font-weight: bold; color: red; margin-top: 30px;">
            본 동의문을 자세히 보지 않고 [동의] 또는 [보내기]를 클릭하였더라도, 모든 내용을 충분히 숙지하고 동의한 것으로 간주됩니다. 반드시 확인 바랍니다.
          </p>
          <form id="opinionForm">
            <input type="email" id="user_email" placeholder="이메일 주소 입력" required /><br />
            <textarea name="message" id="user_message" rows="5" placeholder="의견 내용을 입력하세요" required></textarea><br />
            <button type="submit">보내기</button>
          </form>
        </div>
      </div>
    </div>

    <!-- EmailJS + 동의 관련 스크립트 -->
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script>
      emailjs.init("cEMhcSRW87GAAMaL7");

      // 동의하면 메인앱 보이기
      document.getElementById("consentAgree").addEventListener("click", () => {
        document.getElementById("consentScreen").style.display = "none";
        document.getElementById("mainApp").style.display = "block";
      });

      document.getElementById("showLawModal").addEventListener("click", () => {
        document.getElementById("lawModal").style.display = "block";
      });

      document.getElementById("closeLawModal").addEventListener("click", () => {
        document.getElementById("lawModal").style.display = "none";
      });

      // 의견센터 열기/닫기
      document.getElementById("openModal").addEventListener("click", () => {
        document.getElementById("feedbackModal").style.display = "block";
      });

      document.getElementById("closeModal").addEventListener("click", () => {
        document.getElementById("feedbackModal").style.display = "none";
      });

      // EmailJS 전송
      document.getElementById("opinionForm").addEventListener("submit", function (e) {
        e.preventDefault();

        emailjs.send("service_x70u0xh", "template_62q5w2q", {
          user_email: document.getElementById("user_email").value,
          message: document.getElementById("user_message").value
        })
        .then(() => {
          alert("성공적으로 전송되었습니다!");
          document.getElementById("feedbackModal").style.display = "none";
        })
        .catch((error) => {
          alert("전송 실패: " + error.text);
        });
      });

      // 상품 예시
      const products = [
        {
          number: "1",
          image: "https://thumbnail9.coupangcdn.com/thumbnails/remote/492x492ex/image/vendor_inventory/91d7/4ba4cc9def1ff057f50b1d95b68dbc418a1e9e785a6c2597961ebf28daa2.jpg",
          title: "트랄랄레로 트랄랄라 인형",
          link: "https://link.coupang.com/a/czNwDC"
        }
      ];

      function renderProducts(filter = "") {
        const results = document.getElementById("results");
        results.innerHTML = "";
        const filtered = products.filter((p) => !filter || p.number === filter);

        filtered.forEach((product) => {
          const box = document.createElement("div");
          box.className = "product-box";
          box.innerHTML = `
            <a href="${product.link}" target="_blank" class="product-link">
              <div class="product-info">
                <div class="product-number">${product.number}</div>
                <img src="${product.image}" alt="product ${product.number}" />
              </div>
              <div class="title">${product.title}</div>
            </a>`;
          results.appendChild(box);
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        const input = document.getElementById("searchInput");
        input.addEventListener("input", () => {
          renderProducts(input.value.trim());
        });

        renderProducts();
      });
    </script>
  </body>
  </html>
